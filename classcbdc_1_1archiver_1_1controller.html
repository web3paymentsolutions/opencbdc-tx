<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCBDC Transaction Processor: cbdc::archiver::controller Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OpenCBDC Transaction Processor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classcbdc_1_1archiver_1_1controller.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">cbdc::archiver::controller Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Wrapper for the archiver executable implementation.  
 <a href="classcbdc_1_1archiver_1_1controller.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="atomizer_2archiver_2controller_8hpp_source.html">controller.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a02c7f84a73eec85a7440fe31362261df"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a02c7f84a73eec85a7440fe31362261df">controller</a> ()=delete</td></tr>
<tr class="separator:a02c7f84a73eec85a7440fe31362261df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82c151407aaf3069bc9258df981da57"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#ab82c151407aaf3069bc9258df981da57">controller</a> (const <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;)=delete</td></tr>
<tr class="separator:ab82c151407aaf3069bc9258df981da57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19894341846f65ac5e8448f1d2e7f37"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#ad19894341846f65ac5e8448f1d2e7f37">operator=</a> (const <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;) -&gt; <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;=delete</td></tr>
<tr class="separator:ad19894341846f65ac5e8448f1d2e7f37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9e68ea57b59abe59d90a87f1c784d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a7e9e68ea57b59abe59d90a87f1c784d1">controller</a> (<a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a7e9e68ea57b59abe59d90a87f1c784d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af2a8c5cde06462f39998e13bc289a3"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a9af2a8c5cde06462f39998e13bc289a3">operator=</a> (<a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&amp;) -&gt; <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;=delete</td></tr>
<tr class="separator:a9af2a8c5cde06462f39998e13bc289a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61adec475b63da511d8d8804d44a64a8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a61adec475b63da511d8d8804d44a64a8">controller</a> (uint32_t archiver_id, <a class="el" href="structcbdc_1_1config_1_1options.html">config::options</a> opts, std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt; log, size_t max_samples)</td></tr>
<tr class="memdesc:a61adec475b63da511d8d8804d44a64a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a61adec475b63da511d8d8804d44a64a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67595e205f03d279702a51ccca9fe5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#ad67595e205f03d279702a51ccca9fe5d">~controller</a> ()</td></tr>
<tr class="separator:ad67595e205f03d279702a51ccca9fe5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c8f8641a24cacf68f181e96109736c2"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a0c8f8641a24cacf68f181e96109736c2">init</a> () -&gt; bool</td></tr>
<tr class="memdesc:a0c8f8641a24cacf68f181e96109736c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the controller with all its dependencies.  <br /></td></tr>
<tr class="separator:a0c8f8641a24cacf68f181e96109736c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b7298032589a1845cc0aa496c9a605"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a60b7298032589a1845cc0aa496c9a605">init_leveldb</a> () -&gt; bool</td></tr>
<tr class="memdesc:a60b7298032589a1845cc0aa496c9a605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the LevelDB database.  <br /></td></tr>
<tr class="separator:a60b7298032589a1845cc0aa496c9a605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd4b97561f6f23430cc0fcf8baf34e2"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#adcd4b97561f6f23430cc0fcf8baf34e2">init_best_block</a> () -&gt; bool</td></tr>
<tr class="memdesc:adcd4b97561f6f23430cc0fcf8baf34e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the best block value.  <br /></td></tr>
<tr class="separator:adcd4b97561f6f23430cc0fcf8baf34e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c01e59b53e53886bd5c645c4ab60b0f"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a2c01e59b53e53886bd5c645c4ab60b0f">init_sample_collection</a> () -&gt; bool</td></tr>
<tr class="memdesc:a2c01e59b53e53886bd5c645c4ab60b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the sample collection.  <br /></td></tr>
<tr class="separator:a2c01e59b53e53886bd5c645c4ab60b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af151418ee640fca534185f0e89551023"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#af151418ee640fca534185f0e89551023">init_atomizer_connection</a> () -&gt; bool</td></tr>
<tr class="memdesc:af151418ee640fca534185f0e89551023"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the connection to the atomizer.  <br /></td></tr>
<tr class="separator:af151418ee640fca534185f0e89551023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa562f4b3fc9335b3874ad8d588364fca"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#aa562f4b3fc9335b3874ad8d588364fca">init_archiver_server</a> () -&gt; bool</td></tr>
<tr class="memdesc:aa562f4b3fc9335b3874ad8d588364fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the archiver server.  <br /></td></tr>
<tr class="separator:aa562f4b3fc9335b3874ad8d588364fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c1f6938ff5a5fb576bb9272087e4ed7"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a6c1f6938ff5a5fb576bb9272087e4ed7">best_block_height</a> () const -&gt; uint64_t</td></tr>
<tr class="memdesc:a6c1f6938ff5a5fb576bb9272087e4ed7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the archiver's best block height.  <br /></td></tr>
<tr class="separator:a6c1f6938ff5a5fb576bb9272087e4ed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6d0c9e1bdef5498de80a6af62b58ff"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#aad6d0c9e1bdef5498de80a6af62b58ff">server_handler</a> (<a class="el" href="structcbdc_1_1network_1_1message__t.html">cbdc::network::message_t</a> &amp;&amp;pkt) -&gt; std::optional&lt; <a class="el" href="classcbdc_1_1buffer.html">cbdc::buffer</a> &gt;</td></tr>
<tr class="memdesc:aad6d0c9e1bdef5498de80a6af62b58ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives a request for an archived block and returns the block.  <br /></td></tr>
<tr class="separator:aad6d0c9e1bdef5498de80a6af62b58ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f791f6fab92357d15e539bb09d61b5d"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a4f791f6fab92357d15e539bb09d61b5d">atomizer_handler</a> (<a class="el" href="structcbdc_1_1network_1_1message__t.html">cbdc::network::message_t</a> &amp;&amp;pkt) -&gt; std::optional&lt; <a class="el" href="classcbdc_1_1buffer.html">cbdc::buffer</a> &gt;</td></tr>
<tr class="memdesc:a4f791f6fab92357d15e539bb09d61b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives a serialized block from the atomizer and digests it.  <br /></td></tr>
<tr class="separator:a4f791f6fab92357d15e539bb09d61b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5426eed315c90a6d2ccb33061f9b2a96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a5426eed315c90a6d2ccb33061f9b2a96">digest_block</a> (const <a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a> &amp;blk)</td></tr>
<tr class="memdesc:a5426eed315c90a6d2ccb33061f9b2a96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a block to the archiver database.  <br /></td></tr>
<tr class="separator:a5426eed315c90a6d2ccb33061f9b2a96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08721375557e7c8f0336b8d213ec80bd"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a08721375557e7c8f0336b8d213ec80bd">get_block</a> (uint64_t height) -&gt; std::optional&lt; <a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a> &gt;</td></tr>
<tr class="memdesc:a08721375557e7c8f0336b8d213ec80bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries the archiver database for the block at the specified height.  <br /></td></tr>
<tr class="separator:a08721375557e7c8f0336b8d213ec80bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26f83c5b0e67cc86a8738d017aabcc33"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a26f83c5b0e67cc86a8738d017aabcc33">running</a> () const -&gt; bool</td></tr>
<tr class="memdesc:a26f83c5b0e67cc86a8738d017aabcc33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if this archiver is receiving blocks from the atomizer.  <br /></td></tr>
<tr class="separator:a26f83c5b0e67cc86a8738d017aabcc33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wrapper for the archiver executable implementation. </p>
<p>Connects to the atomizer cluster to receive new blocks and listens for historical block requests from clients. </p>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8hpp_source.html#l00021">21</a> of file <a class="el" href="atomizer_2archiver_2controller_8hpp_source.html">atomizer/archiver/controller.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a02c7f84a73eec85a7440fe31362261df" name="a02c7f84a73eec85a7440fe31362261df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c7f84a73eec85a7440fe31362261df">&#9670;&#160;</a></span>controller() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::archiver::controller::controller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ab82c151407aaf3069bc9258df981da57" name="ab82c151407aaf3069bc9258df981da57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82c151407aaf3069bc9258df981da57">&#9670;&#160;</a></span>controller() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::archiver::controller::controller </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7e9e68ea57b59abe59d90a87f1c784d1" name="a7e9e68ea57b59abe59d90a87f1c784d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e9e68ea57b59abe59d90a87f1c784d1">&#9670;&#160;</a></span>controller() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::archiver::controller::controller </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a61adec475b63da511d8d8804d44a64a8" name="a61adec475b63da511d8d8804d44a64a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61adec475b63da511d8d8804d44a64a8">&#9670;&#160;</a></span>controller() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::archiver::controller::controller </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>archiver_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcbdc_1_1config_1_1options.html">config::options</a>&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcbdc_1_1logging_1_1log.html">logging::log</a> &gt;&#160;</td>
          <td class="paramname"><em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">archiver_id</td><td>the running ID of this archiver. </td></tr>
    <tr><td class="paramname">opts</td><td>configuration options. </td></tr>
    <tr><td class="paramname">log</td><td>pointer to shared logger. </td></tr>
    <tr><td class="paramname">max_samples</td><td>maximum number of blocks to digest, for testing. 0=unlimited. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00016">16</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="ad67595e205f03d279702a51ccca9fe5d" name="ad67595e205f03d279702a51ccca9fe5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad67595e205f03d279702a51ccca9fe5d">&#9670;&#160;</a></span>~controller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cbdc::archiver::controller::~controller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00025">25</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

<p class="reference">References <a class="el" href="connection__manager_8cpp_source.html#l00184">cbdc::network::connection_manager::close()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1archiver_1_1controller_ad67595e205f03d279702a51ccca9fe5d_cgraph.png" border="0" usemap="#aclasscbdc_1_1archiver_1_1controller_ad67595e205f03d279702a51ccca9fe5d_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1archiver_1_1controller_ad67595e205f03d279702a51ccca9fe5d_cgraph" id="aclasscbdc_1_1archiver_1_1controller_ad67595e205f03d279702a51ccca9fe5d_cgraph">
<area shape="rect" title=" " alt="" coords="5,95,166,135"/>
<area shape="rect" href="classcbdc_1_1network_1_1connection__manager.html#a7be9b6b8c582cb5f3fdea1a9a34210a9" title="Shuts down the network listener and all existing peer connections." alt="" coords="214,95,384,135"/>
<area shape="rect" href="classcbdc_1_1network_1_1tcp__listener.html#a9efda29d6a5995e2987e915aba3112e1" title="Stops the listener and unblocks any blocking calls associated with this listener." alt="" coords="443,29,568,70"/>
<area shape="rect" href="classcbdc_1_1network_1_1peer.html#ad1121cc2946655fec2e53cb4704cc3cc" title="Clears any packets in the pending send queue." alt="" coords="439,95,571,135"/>
<area shape="rect" href="classcbdc_1_1network_1_1socket__selector.html#abdfae01b7d5bb06cd0431f6780f33d8b" title="Unblocks a blocked wait() call." alt="" coords="432,160,578,201"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4f791f6fab92357d15e539bb09d61b5d" name="a4f791f6fab92357d15e539bb09d61b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f791f6fab92357d15e539bb09d61b5d">&#9670;&#160;</a></span>atomizer_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::atomizer_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcbdc_1_1network_1_1message__t.html">cbdc::network::message_t</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pkt</em></td><td>)</td>
          <td> -&gt; std::optional&lt;<a class="el" href="classcbdc_1_1buffer.html">cbdc::buffer</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives a serialized block from the atomizer and digests it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>packet containing the serialized block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::nullopt; no reply to atomizer necessary. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcbdc_1_1archiver_1_1controller.html#a5426eed315c90a6d2ccb33061f9b2a96">digest_block</a> </dd>
<dd>
<a class="el" href="namespacecbdc_1_1network.html#a16b985d0607669909bf03144fcdb8416">network::packet_handler_t</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00150">150</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="a6c1f6938ff5a5fb576bb9272087e4ed7" name="a6c1f6938ff5a5fb576bb9272087e4ed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c1f6938ff5a5fb576bb9272087e4ed7">&#9670;&#160;</a></span>best_block_height()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::best_block_height </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const -&gt; uint64_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the archiver's best block height. </p>
<dl class="section return"><dt>Returns</dt><dd>best block height. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00165">165</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="a5426eed315c90a6d2ccb33061f9b2a96" name="a5426eed315c90a6d2ccb33061f9b2a96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5426eed315c90a6d2ccb33061f9b2a96">&#9670;&#160;</a></span>digest_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cbdc::archiver::controller::digest_block </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a> &amp;&#160;</td>
          <td class="paramname"><em>blk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a block to the archiver database. </p>
<p>Initializes the best block height field on its first call. If the controller's known best block height is not contiguous with the height of the provided block, recursively requests preceding blocks from the atomizer. Stores each received block in a deferred processing cache until receiving the next contiguous block, then digests each block in order.</p>
<p>Instructs connected atomizers to prune digested blocks. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blk</td><td>block to digest. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00169">169</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

<p class="reference">References <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00169">digest_block()</a>, <a class="el" href="block_8hpp_source.html#l00024">cbdc::atomizer::block::m_height</a>, <a class="el" href="block_8hpp_source.html#l00026">cbdc::atomizer::block::m_transactions</a>, and <a class="el" href="raft_2util_8hpp_source.html#l00020">cbdc::make_buffer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00169">digest_block()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1archiver_1_1controller_a5426eed315c90a6d2ccb33061f9b2a96_cgraph.png" border="0" usemap="#aclasscbdc_1_1archiver_1_1controller_a5426eed315c90a6d2ccb33061f9b2a96_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1archiver_1_1controller_a5426eed315c90a6d2ccb33061f9b2a96_cgraph" id="aclasscbdc_1_1archiver_1_1controller_a5426eed315c90a6d2ccb33061f9b2a96_cgraph">
<area shape="rect" title="Adds a block to the archiver database." alt="" coords="5,29,166,70"/>
<area shape="rect" href="namespacecbdc.html#aed9c6313b2ae6e3d7f01340ab5a3076b" title="Serialize object into nuraft::buffer using a cbdc::nuraft_serializer." alt="" coords="214,37,340,63"/>
<area shape="rect" href="namespacecbdc.html#a4dd685b58c8cf66f4489ab808915ab85" title="Calculates the serialized size in bytes of the given object when serialized using serializer." alt="" coords="388,37,527,63"/>
</map>
</div>

</div>
</div>
<a id="a08721375557e7c8f0336b8d213ec80bd" name="a08721375557e7c8f0336b8d213ec80bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08721375557e7c8f0336b8d213ec80bd">&#9670;&#160;</a></span>get_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::get_block </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>height</em></td><td>)</td>
          <td> -&gt; std::optional&lt;<a class="el" href="structcbdc_1_1atomizer_1_1block.html">cbdc::atomizer::block</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queries the archiver database for the block at the specified height. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">height</td><td>the height of the block to retrieve. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the block at the specified height, or std::nullopt if the database does not contain a block at that height. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00253">253</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="a0c8f8641a24cacf68f181e96109736c2" name="a0c8f8641a24cacf68f181e96109736c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c8f8641a24cacf68f181e96109736c2">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the controller with all its dependencies. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00040">40</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="aa562f4b3fc9335b3874ad8d588364fca" name="aa562f4b3fc9335b3874ad8d588364fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa562f4b3fc9335b3874ad8d588364fca">&#9670;&#160;</a></span>init_archiver_server()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init_archiver_server </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the archiver server. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00118">118</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="af151418ee640fca534185f0e89551023" name="af151418ee640fca534185f0e89551023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af151418ee640fca534185f0e89551023">&#9670;&#160;</a></span>init_atomizer_connection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init_atomizer_connection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the connection to the atomizer. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00104">104</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="adcd4b97561f6f23430cc0fcf8baf34e2" name="adcd4b97561f6f23430cc0fcf8baf34e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd4b97561f6f23430cc0fcf8baf34e2">&#9670;&#160;</a></span>init_best_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init_best_block </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the best block value. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00078">78</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="a60b7298032589a1845cc0aa496c9a605" name="a60b7298032589a1845cc0aa496c9a605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60b7298032589a1845cc0aa496c9a605">&#9670;&#160;</a></span>init_leveldb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init_leveldb </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the LevelDB database. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00059">59</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="a2c01e59b53e53886bd5c645c4ab60b0f" name="a2c01e59b53e53886bd5c645c4ab60b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c01e59b53e53886bd5c645c4ab60b0f">&#9670;&#160;</a></span>init_sample_collection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::init_sample_collection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the sample collection. </p>
<dl class="section return"><dt>Returns</dt><dd>true if initialization succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00094">94</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="ad19894341846f65ac5e8448f1d2e7f37" name="ad19894341846f65ac5e8448f1d2e7f37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad19894341846f65ac5e8448f1d2e7f37">&#9670;&#160;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt;  <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;=delete</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9af2a8c5cde06462f39998e13bc289a3" name="a9af2a8c5cde06462f39998e13bc289a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9af2a8c5cde06462f39998e13bc289a3">&#9670;&#160;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> -&gt;  <a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a> &amp;=delete</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a26f83c5b0e67cc86a8738d017aabcc33" name="a26f83c5b0e67cc86a8738d017aabcc33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f83c5b0e67cc86a8738d017aabcc33">&#9670;&#160;</a></span>running()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::running </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const -&gt; bool</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if this archiver is receiving blocks from the atomizer. </p>
<p>Will be true while the total number of digested blocks is less than max_samples. </p><dl class="section return"><dt>Returns</dt><dd>false if the controller is finished digesting blocks. </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00135">135</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

</div>
</div>
<a id="aad6d0c9e1bdef5498de80a6af62b58ff" name="aad6d0c9e1bdef5498de80a6af62b58ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6d0c9e1bdef5498de80a6af62b58ff">&#9670;&#160;</a></span>server_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">auto cbdc::archiver::controller::server_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcbdc_1_1network_1_1message__t.html">cbdc::network::message_t</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>pkt</em></td><td>)</td>
          <td> -&gt; std::optional&lt;<a class="el" href="classcbdc_1_1buffer.html">cbdc::buffer</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives a request for an archived block and returns the block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>packet containing the request. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>block or std::nullopt from <a class="el" href="classcbdc_1_1archiver_1_1controller.html#a08721375557e7c8f0336b8d213ec80bd">get_block</a>. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespacecbdc_1_1network.html#a16b985d0607669909bf03144fcdb8416">network::packet_handler_t</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html#l00139">139</a> of file <a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a>.</p>

<p class="reference">References <a class="el" href="raft_2util_8hpp_source.html#l00020">cbdc::make_buffer()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcbdc_1_1archiver_1_1controller_aad6d0c9e1bdef5498de80a6af62b58ff_cgraph.png" border="0" usemap="#aclasscbdc_1_1archiver_1_1controller_aad6d0c9e1bdef5498de80a6af62b58ff_cgraph" alt=""/></div>
<map name="aclasscbdc_1_1archiver_1_1controller_aad6d0c9e1bdef5498de80a6af62b58ff_cgraph" id="aclasscbdc_1_1archiver_1_1controller_aad6d0c9e1bdef5498de80a6af62b58ff_cgraph">
<area shape="rect" title="Receives a request for an archived block and returns the block." alt="" coords="5,5,166,46"/>
<area shape="rect" href="namespacecbdc.html#aed9c6313b2ae6e3d7f01340ab5a3076b" title="Serialize object into nuraft::buffer using a cbdc::nuraft_serializer." alt="" coords="214,13,340,39"/>
<area shape="rect" href="namespacecbdc.html#a4dd685b58c8cf66f4489ab808915ab85" title="Calculates the serialized size in bytes of the given object when serialized using serializer." alt="" coords="388,13,527,39"/>
</map>
</div>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="atomizer_2archiver_2controller_8hpp_source.html">atomizer/archiver/controller.hpp</a></li>
<li><a class="el" href="atomizer_2archiver_2controller_8cpp_source.html">atomizer/archiver/controller.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecbdc.html">cbdc</a></li><li class="navelem"><a class="el" href="namespacecbdc_1_1archiver.html">archiver</a></li><li class="navelem"><a class="el" href="classcbdc_1_1archiver_1_1controller.html">controller</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
